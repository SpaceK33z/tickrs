## 2026-01-13: Fixed compilation errors and failing tests

### Problem
The project had compilation errors in two files:
1. `src/config/mod.rs` - Raw string literals with `#` characters were not being parsed correctly
2. `src/models/project.rs` - Same issue with JSON test strings containing `#FF5733` color codes

Additionally, `test_config_default` was failing because `#[derive(Default)]` doesn't apply serde default functions.

### Solution
1. Replaced multi-line raw string literals (`r#"..."#`) with single-line escaped strings
2. Implemented `Default` trait manually for `Config` struct to properly use the `default_project_color()` function

### Changes Made
- `src/config/mod.rs`:
  - Changed `test_config_deserialization` to use escaped string instead of raw string
  - Added manual `impl Default for Config` to ensure `default_project_color` is applied
- `src/models/project.rs`:
  - Changed `test_project_deserialization` to use escaped JSON string
  - Changed `test_project_data_deserialization` to use escaped JSON string

### Results
- All 23 tests pass
- Project compiles successfully
- Clippy shows only expected dead_code warnings (code not yet used) and minor suggestions

## 2026-01-14: Fixed missing INBOX_PROJECT_ID export

### Problem
The project had a compilation error - `INBOX_PROJECT_ID` was defined in `src/models/project.rs` but not exported from `src/models/mod.rs`, causing `src/api/project.rs` to fail compilation.

### Solution
Added `INBOX_PROJECT_ID` to the public exports in `src/models/mod.rs`.

### Changes Made
- `src/models/mod.rs`:
  - Added `INBOX_PROJECT_ID` to the `pub use project::` statement

### Results
- All 27 tests pass
- Project compiles successfully
- Clippy shows only expected dead_code warnings (code not yet used)

## 2026-01-14: Implemented Phase 6 - Task API Endpoints

### What was done
Implemented all task-related API endpoints in `src/api/task.rs` as specified in PRD Phase 6.

### API Methods Implemented
1. `list_tasks(project_id)` - List all tasks in a project (uses GET /project/{id}/data)
2. `get_task(project_id, task_id)` - Get single task (GET /project/{projectId}/task/{taskId})
3. `create_task(request)` - Create new task (POST /task)
4. `update_task(task_id, request)` - Update task (POST /task/{id})
5. `delete_task(project_id, task_id)` - Delete task (DELETE /project/{projectId}/task/{taskId})
6. `complete_task(project_id, task_id)` - Mark complete (POST /project/{projectId}/task/{taskId}/complete)
7. `uncomplete_task(project_id, task_id)` - Mark incomplete (updates status to 0)

### Request Types Added
- `CreateTaskRequest` - For creating tasks with optional fields (content, priority, dates, tags, etc.)
- `UpdateTaskRequest` - For updating tasks with optional fields including status

### Changes Made
- `src/api/task.rs`: Complete implementation with 7 API methods and 2 request types
- `src/api/mod.rs`: Added exports for `CreateTaskRequest` and `UpdateTaskRequest`

### Results
- All 31 tests pass (4 new tests for task request serialization)
- Project compiles successfully
- Clippy shows only expected dead_code warnings (CLI not yet implemented)

## 2026-01-14: Implemented Phase 7 - Output Formatting

### What was done
Implemented the output formatting module in `src/output/` as specified in PRD Phase 7.

### Module Structure
- `src/output/mod.rs` - Module exports and `OutputFormat` enum (Text/Json)
- `src/output/json.rs` - JSON output formatting with standard response wrapper
- `src/output/text.rs` - Text output formatting for human-readable output

### JSON Output Implementation
- `JsonResponse<T>` - Generic response wrapper with success, data, error, and message fields
- `ErrorDetail` - Error details with code, message, and optional details
- Helper functions: `result_to_json`, `result_to_json_with_message`
- Data wrappers: `ProjectListData`, `ProjectData`, `TaskListData`, `TaskData`, `SubtaskListData`, `VersionData`
- All responses match PRD JSON specification format

### Text Output Implementation
- `format_project_list` / `format_project_details` - Project formatting
- `format_task_list` / `format_task_details` - Task formatting with priority markers [L]/[M]/[H]
- `format_subtask_list` - Subtask/checklist item formatting
- `format_success` / `format_success_with_id` / `format_error` - Status message formatting
- `format_version` - Version info formatting

### Changes Made
- Created `src/output/mod.rs`
- Created `src/output/json.rs` with 7 tests
- Created `src/output/text.rs` with 12 tests
- Updated `src/main.rs` to include output module

### Results
- All 50 tests pass (19 new tests for output module)
- Project compiles successfully
- Clippy shows only expected dead_code warnings (CLI not yet wired up)

## 2026-01-14: Implemented Phase 8 - Utilities

### What was done
Implemented the utilities module as specified in PRD Phase 8, including date parsing and error handling.

### Module Structure
- `src/utils/mod.rs` - Module exports
- `src/utils/date_parser.rs` - Natural language date parsing
- `src/utils/error.rs` - Application error types with error codes
- `src/constants.rs` - Centralized constants

### Date Parser Implementation (`utils/date_parser.rs`)
- `parse_date(input)` - Parse natural language or ISO dates to `DateTime<Utc>`
  - Supports: "today", "tomorrow", "yesterday", "next week", "next month"
  - Supports: "in X days/hours/minutes/weeks/months"
  - Supports: ISO 8601 formats via dateparser crate
- `parse_date_with_timezone(input, timezone)` - Parse with specific timezone
- `parse_future_date(input)` - Parse and validate date is not in the past
- `format_datetime(dt, timezone)` - Format datetime for display
- `local_timezone()` - Get system timezone
- `DateParseError` enum with user-friendly messages

### Error Handling Implementation (`utils/error.rs`)
- `ErrorCode` enum - Serializable error codes for JSON output:
  - AUTH_REQUIRED, AUTH_EXPIRED, NOT_FOUND, INVALID_REQUEST
  - RATE_LIMITED, SERVER_ERROR, NETWORK_ERROR, PARSE_ERROR
  - CONFIG_ERROR, INVALID_DATE, NO_PROJECT, UNKNOWN
- `AppError` enum - User-friendly error messages with actionable guidance
- Conversion implementations from `ApiError`, `DateParseError`, and `anyhow::Error`

### Constants Implementation (`constants.rs`)
- API constants: `API_BASE_URL`
- OAuth constants: `OAUTH_AUTH_URL`, `OAUTH_TOKEN_URL`, `OAUTH_REDIRECT_URI`, `OAUTH_SCOPES`
- Project constants: `INBOX_PROJECT_ID`, `INBOX_PROJECT_NAME`, `DEFAULT_PROJECT_COLOR`
- File constants: `CONFIG_FILE_NAME`, `TOKEN_FILE_NAME`, `APP_DIR_NAME`
- Environment variables: `ENV_CLIENT_ID`, `ENV_CLIENT_SECRET`, `ENV_LOG_LEVEL`, `DEFAULT_LOG_LEVEL`

### Changes Made
- Created `src/utils/mod.rs`
- Created `src/utils/date_parser.rs` with 13 tests
- Created `src/utils/error.rs` with 5 tests
- Created `src/constants.rs` with 6 tests
- Updated `src/main.rs` to include utils and constants modules

### Results
- All 74 tests pass (24 new tests)
- Project compiles successfully
- Clippy shows only expected dead_code warnings (CLI not yet wired up)

## 2026-01-14: Implemented Phase 9 - CLI Root Commands

### What was done
Implemented the CLI root commands (init, reset, version) as specified in PRD Phase 9.

### OAuth Authentication (`api/auth.rs`)
- `AuthHandler` struct for managing OAuth flow
- `get_auth_url()` - Generates authorization URL with CSRF token
- `run_oauth_flow()` - Full OAuth flow: open browser, capture callback, exchange code
- `capture_callback()` - TCP listener on localhost:8080 to capture authorization code
- `exchange_code()` - Exchange authorization code for access token
- Uses oauth2 crate v5 with proper type configuration
- HTML success/error pages displayed after authorization

### CLI Commands Implemented
- **`tickrs init`** - OAuth authentication flow
  - Checks if already authenticated
  - Loads client credentials from environment variables
  - Opens browser for TickTick authorization
  - Captures callback and exchanges code for token
  - Saves token and initializes config
  - Supports `--json` output

- **`tickrs reset`** - Clear configuration and credentials
  - Checks if anything exists to reset
  - Confirmation prompt (skippable with `--force`)
  - Deletes token and config files
  - Supports `--json` output

- **`tickrs version`** - Display version information
  - Shows name and version from Cargo.toml
  - Supports `--json` and `--quiet` flags

### Main Entry Point (`main.rs`)
- Async runtime with tokio
- Command dispatch with proper error handling
- Output format handling (JSON/Text)
- Quiet mode support
- Exit codes for success/failure

### Changes Made
- `src/api/auth.rs`: Full OAuth implementation with 8 tests
- `src/api/mod.rs`: Added `AuthHandler` export
- `src/cli/mod.rs`: Added `Commands` export
- `src/main.rs`: Complete command dispatch and handlers

### Results
- All 82 tests pass (8 new tests for OAuth)
- Project compiles successfully
- CLI commands work correctly:
  - `tickrs version` outputs "tickrs 0.1.0"
  - `tickrs --json version` outputs proper JSON
  - `tickrs reset --force` handles no-config case
  - `tickrs --help` shows all commands
- Clippy shows only expected dead_code warnings (later phases not yet implemented)

## 2026-01-14: Implemented Phase 10 - CLI Project Commands

### What was done
Implemented all project CLI commands in `main.rs` as specified in PRD Phase 10.

### Commands Implemented
1. **`project list`** (alias: `ls`)
   - Lists all projects from TickTick API (including INBOX)
   - Supports `--json` output for machine consumption
   - Text output shows ID, name, and color

2. **`project show <id>`**
   - Shows detailed information about a specific project
   - Supports `--json` output
   - Text output shows all project fields

3. **`project use <name-or-id>`**
   - Sets the default project for subsequent commands
   - Finds project by ID or name (case-insensitive)
   - Saves selection to config file

4. **`project create`**
   - Creates a new project with specified options
   - Flags: `--name` (required), `--color`, `--view-mode`, `--kind`
   - Returns created project with ID

5. **`project update <id>`**
   - Updates an existing project
   - Flags: `--name`, `--color`, `--closed`
   - Returns updated project

6. **`project delete <id>`**
   - Deletes a project (with confirmation prompt)
   - Use `--force` to skip confirmation
   - Works with `--json` flag to skip prompt

### Changes Made
- `src/main.rs`:
  - Added imports for `CreateProjectRequest`, `UpdateProjectRequest`, `TickTickClient`
  - Added imports for `ProjectData`, `ProjectListData` output wrappers
  - Wired up `Commands::Project` to `cmd_project` handler
  - Implemented `cmd_project` dispatcher function
  - Implemented `cmd_project_list` - lists all projects
  - Implemented `cmd_project_show` - shows project details
  - Implemented `cmd_project_use` - sets default project
  - Implemented `cmd_project_create` - creates new project
  - Implemented `cmd_project_update` - updates existing project
  - Implemented `cmd_project_delete` - deletes project with confirmation

### Results
- All 82 tests pass
- Project compiles successfully
- All project commands work with both `--json` and text output
- `ls` alias works for `list` command
- Clippy shows only expected dead_code warnings (task/subtask commands not yet implemented)

## 2026-01-14: Implemented Phase 11 - CLI Task Commands

### What was done
Implemented all task CLI commands in `main.rs` as specified in PRD Phase 11.

### Commands Implemented
1. **`task list`** (alias: `ls`)
   - Lists all tasks in a project
   - Optional `--project-id` or uses default from config
   - Optional filters: `--priority`, `--tag`, `--status`
   - Supports `--json` output
   - Text output shows checkbox, priority marker, title, and due date

2. **`task show <id>`**
   - Shows detailed information about a specific task
   - Optional `--project-id` or uses default
   - Supports `--json` output
   - Text output shows all task fields including subtasks

3. **`task create`** (alias: `add`)
   - Creates a new task with specified options
   - Required: `--title`
   - Optional flags: `--project-id`, `--content`, `--priority`, `--tags`, `--date`, `--start`, `--due`, `--all-day`, `--timezone`
   - Natural language date parsing (e.g., "tomorrow", "in 3 days")
   - Returns created task with ID

4. **`task update <id>`**
   - Updates an existing task
   - Same flags as create (except --title is optional)
   - Returns updated task

5. **`task delete <id>`**
   - Deletes a task (with confirmation prompt)
   - Optional `--project-id`
   - Use `--force` to skip confirmation

6. **`task complete <id>`**
   - Marks a task as complete
   - Optional `--project-id`

7. **`task uncomplete <id>`**
   - Marks a task as incomplete
   - Optional `--project-id`

### Key Features
- **Default Project Support**: All task commands use the default project from config if `--project-id` is not specified
- **Filtering**: List command supports filtering by priority, tag, and status (complete/incomplete)
- **Natural Language Dates**: The `--date` flag accepts expressions like "today", "tomorrow", "in 3 days"
- **Tags**: Comma-separated tags can be specified with `--tags`

### Changes Made
- `src/main.rs`:
  - Added imports for `CreateTaskRequest`, `UpdateTaskRequest`, `TaskCommands`
  - Added imports for `TaskData`, `TaskListData` output wrappers
  - Added imports for `Priority`, `Status`, and `parse_date`
  - Wired up `Commands::Task` to `cmd_task` handler
  - Implemented `cmd_task` dispatcher function
  - Implemented `get_project_id` helper function for default project resolution
  - Implemented `cmd_task_list` - lists tasks with optional filtering
  - Implemented `cmd_task_show` - shows task details
  - Implemented `cmd_task_create` - creates new task with date parsing
  - Implemented `cmd_task_update` - updates existing task
  - Implemented `cmd_task_delete` - deletes task with confirmation
  - Implemented `cmd_task_complete` - marks task complete
  - Implemented `cmd_task_uncomplete` - marks task incomplete
  - Implemented `parse_task_dates` - parses date options into API format

### Results
- All 82 tests pass
- Project compiles successfully
- All task commands work with both `--json` and text output
- `ls` alias works for `list` command, `add` alias works for `create`
- Date parsing integrates with natural language support
- Clippy shows only expected dead_code warnings (subtask commands not yet implemented)

## 2026-01-14: Implemented Phase 12 - CLI Subtask Commands

### What was done
Implemented the subtask list command in `main.rs` as specified in PRD Phase 12.

### Commands Implemented
1. **`subtask list <task-id>`** (alias: `ls`)
   - Lists all subtasks (checklist items) for a given task
   - Optional `--project-id` or uses default from config
   - Supports `--json` output
   - Text output shows checkbox status and title for each subtask

### Key Features
- **Default Project Support**: Uses the default project from config if `--project-id` is not specified
- **JSON Output**: Returns structured JSON with subtasks array and count
- **Text Output**: Displays human-readable list with status markers [x]/[ ]

### Changes Made
- `src/main.rs`:
  - Added import for `SubtaskCommands`
  - Added import for `SubtaskListData` output wrapper
  - Wired up `Commands::Subtask` to `cmd_subtask` handler
  - Implemented `cmd_subtask` dispatcher function
  - Implemented `cmd_subtask_list` - lists subtasks for a task

### Results
- All 82 tests pass
- Project compiles successfully
- Subtask list command works with both `--json` and text output
- `ls` alias works for `list` command
- Clippy shows only expected dead_code warnings (later phases not yet implemented)

## 2026-01-14: Fixed clippy warnings to achieve zero warnings in CI (Phase 13)

### What was done
Fixed all clippy warnings to pass CI checks with `cargo clippy -- -D warnings`.

### Issues Fixed
1. **Unused imports** - Removed re-exports not used externally from:
   - `src/api/mod.rs` - Removed `API_BASE_URL` export
   - `src/output/mod.rs` - Removed unused `JsonResponse`, `ErrorDetail` exports
   - `src/utils/mod.rs` - Removed unused date_parser and error re-exports

2. **Dead code warnings** - Added `#[allow(dead_code)]` for public API items not yet used:
   - `src/constants.rs` - Module-level allow for all constants
   - `src/models/task.rs` - TaskBuilder struct and impl
   - `src/output/mod.rs` - `is_json()` method
   - `src/output/json.rs` - `error()`, `error_with_details()`, `result_to_json()`, `result_to_json_with_message()` functions
   - `src/output/text.rs` - `format_error()` function
   - `src/utils/date_parser.rs` - `InvalidTimezone`, `PastDate` variants, `parse_date_with_timezone()`, `parse_future_date()`, `local_timezone()`, `format_datetime()` functions
   - `src/utils/error.rs` - `ErrorCode` enum, `AppError` enum and impl

3. **Type complexity warning** - Added `#[allow(clippy::type_complexity)]` for OAuth client type in `src/api/auth.rs`

4. **Derivable impls** - Changed manual `Default` implementations to use `#[derive(Default)]` with `#[default]` attribute:
   - `src/models/priority.rs` - `Priority::None` as default
   - `src/models/status.rs` - `Status::Normal` as default

5. **Code formatting** - Ran `cargo fmt` to fix formatting issues

### Changes Made
- `src/api/mod.rs`: Removed unused export
- `src/api/auth.rs`: Added clippy allow, reformatted
- `src/output/mod.rs`: Removed unused exports, added dead_code allow
- `src/output/json.rs`: Added dead_code allows
- `src/output/text.rs`: Added dead_code allow
- `src/utils/mod.rs`: Removed unused re-exports
- `src/utils/date_parser.rs`: Added dead_code allows
- `src/utils/error.rs`: Added dead_code allows
- `src/models/priority.rs`: Changed to derive Default
- `src/models/status.rs`: Changed to derive Default
- `src/models/task.rs`: Added dead_code allow to impl
- `src/constants.rs`: Added module-level dead_code allow

### Results
- All 82 tests pass
- `cargo clippy -- -D warnings` passes with no errors
- `cargo fmt --check` passes
- PRD Phase 13 "Zero clippy warnings in CI" requirement fulfilled

## 2026-01-14: Added cross-platform build to CI (Phase 13)

### What was done
Added cross-platform build job to GitHub Actions CI workflow to complete Phase 13's CI/CD requirements.

### Changes Made
- `.github/workflows/ci.yml`:
  - Added `build` job with matrix strategy for ubuntu-latest, macos-latest, windows-latest
  - Builds release binary on all three platforms
  - Uses dtolnay/rust-toolchain and Swatinem/rust-cache for consistency

### Results
- All 82 tests pass
- Release build succeeds
- CI/CD pipeline now includes cross-platform builds
- PRD Phase 13 "Add CI/CD pipeline (GitHub Actions)" fully complete

## 2026-01-14: Added edge case unit tests (Phase 13)

### What was done
Added comprehensive unit tests for edge cases as specified in PRD Phase 13.

### Tests Added

#### Task Model (`src/models/task.rs`)
- `test_task_special_characters_in_title` - Tests special characters, HTML entities, quotes, and emojis in task titles with round-trip serialization
- `test_task_with_subtasks` - Tests task with multiple subtasks, verifying checklist item parsing
- `test_task_with_dates` - Tests all-day tasks with due date, start date, timezone, and high priority
- `test_task_completed` - Tests completed task with completion timestamp and status
- `test_task_minimal_json` - Tests deserializing tasks with only required fields (verifies defaults)

#### Project Model (`src/models/project.rs`)
- `test_project_special_characters_in_name` - Tests special characters in project names with round-trip
- `test_project_minimal_json` - Tests deserializing with minimal fields (verifies defaults)
- `test_project_closed` - Tests archived/closed project state
- `test_project_with_group` - Tests project with group ID and kanban view mode
- `test_project_data_with_columns` - Tests kanban columns parsing

#### Subtask Model (`src/models/subtask.rs`)
- `test_checklist_item_special_characters` - Tests special characters in subtask titles
- `test_checklist_item_minimal_json` - Tests minimal JSON with defaults
- `test_checklist_item_with_start_date` - Tests all-day subtask with start date and timezone

### Changes Made
- `src/models/task.rs`: Added 5 new edge case tests
- `src/models/project.rs`: Added 5 new edge case tests
- `src/models/subtask.rs`: Added 3 new edge case tests
- `plans/PRD.md`: Marked "Test edge cases" section as complete

### Results
- All 95 tests pass (13 new tests)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "Test edge cases" requirement complete

## 2026-01-14: Added error handling coverage tests (Phase 13)

### What was done
Added comprehensive unit tests for error conversion functions (`From` trait implementations) to complete the "Add error handling coverage" item in PRD Phase 13.

### Tests Added (`src/utils/error.rs`)
1. `test_from_api_error_not_authenticated` - Verifies NotAuthenticated → AuthRequired conversion
2. `test_from_api_error_unauthorized` - Verifies Unauthorized → AuthExpired conversion
3. `test_from_api_error_not_found` - Verifies NotFound resource conversion with message preservation
4. `test_from_api_error_bad_request` - Verifies BadRequest → InvalidRequest conversion
5. `test_from_api_error_rate_limited` - Verifies RateLimited conversion
6. `test_from_api_error_server_error` - Verifies ServerError conversion with message
7. `test_from_api_error_parse_error` - Verifies ParseError conversion
8. `test_from_date_parse_error_invalid_format` - Verifies InvalidFormat → InvalidDate conversion
9. `test_from_date_parse_error_invalid_timezone` - Verifies InvalidTimezone conversion
10. `test_from_date_parse_error_past_date` - Verifies PastDate conversion
11. `test_from_anyhow_error` - Verifies anyhow::Error → Other conversion
12. `test_all_error_codes_have_display` - Verifies all ErrorCode variants display as SCREAMING_SNAKE_CASE

### Changes Made
- `src/utils/error.rs`: Added 12 new tests for error conversion coverage
- `plans/PRD.md`: Marked "Add error handling coverage" section as complete

### Results
- All 107 tests pass (12 new tests)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "Add error handling coverage" requirement complete

## 2026-01-14: Added date parsing edge case unit tests (Phase 13)

### What was done
Added comprehensive unit tests for date parsing edge cases to complete the "Utils: Date parsing edge cases" item in PRD Phase 13.

### Tests Added (`src/utils/date_parser.rs`)
1. `test_parse_yesterday` - Tests parsing "yesterday" keyword
2. `test_parse_next_week` - Tests parsing "next week" keyword
3. `test_parse_next_month` - Tests parsing "next month" keyword
4. `test_parse_in_hours` - Tests parsing "in X hours" format
5. `test_parse_in_minutes` - Tests parsing "in X minutes" format
6. `test_parse_in_weeks` - Tests parsing "in X weeks" format
7. `test_parse_in_months` - Tests parsing "in X months" format
8. `test_parse_case_insensitive` - Tests case-insensitive parsing (TODAY, Tomorrow, etc.)
9. `test_parse_whitespace_handling` - Tests trimming of leading/trailing whitespace
10. `test_parse_singular_units` - Tests singular unit forms (day, week, hour, minute, month)
11. `test_parse_min_abbreviation` - Tests min/mins abbreviation for minutes
12. `test_parse_future_date_valid` - Tests parse_future_date with valid future date
13. `test_parse_future_date_past` - Tests parse_future_date rejects past dates
14. `test_parse_date_with_timezone_datetime` - Tests datetime with timezone context
15. `test_format_datetime_invalid_timezone_fallback` - Tests fallback to UTC on invalid timezone
16. `test_parse_incomplete_relative_time` - Tests rejection of incomplete "in X" formats
17. `test_parse_invalid_relative_unit` - Tests rejection of invalid time units

### Changes Made
- `src/utils/date_parser.rs`: Added 17 new tests for date parsing edge cases
- `plans/PRD.md`: Marked "Utils: Date parsing edge cases" as complete

### Results
- All 124 tests pass (17 new tests)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "Utils: Date parsing edge cases" requirement complete

## 2026-01-14: Added config file operations unit tests (Phase 13)

### What was done
Added comprehensive unit tests for config file operations to complete the "Config: File operations" item in PRD Phase 13.

### Tests Added (`src/config/mod.rs`)
1. `test_data_dir` - Tests Config::data_dir() returns correct path
2. `test_config_save_and_load_to_custom_path` - Tests config save/load roundtrip
3. `test_config_save_creates_parent_directories` - Tests directory creation
4. `test_config_delete_file` - Tests config file deletion
5. `test_config_delete_nonexistent_file` - Tests idempotent delete on missing file
6. `test_token_save_and_load_to_custom_path` - Tests token save/load roundtrip
7. `test_token_load_empty_file` - Tests empty token file handling
8. `test_token_load_whitespace_only` - Tests whitespace-only token handling
9. `test_token_load_nonexistent` - Tests nonexistent token file handling
10. `test_token_delete_file` - Tests token file deletion
11. `test_token_exists_check` - Tests token existence checking
12. `test_token_save_permissions` (unix only) - Tests 0600 permission setting
13. `test_config_roundtrip_with_special_characters` - Tests special chars in project ID
14. `test_token_with_special_characters` - Tests JWT-style tokens with special chars

### Changes Made
- `src/config/mod.rs`: Added 14 new tests for file operations
- `plans/PRD.md`: Marked "Config: File operations" as complete

### Results
- All 138 tests pass (14 new tests)
- `cargo clippy -- -D warnings` passes
- PRD Phase 13 "Config: File operations" requirement complete

## 2026-01-14: Added API client integration tests with mock server (Phase 13)

### What was done
Added comprehensive integration tests for the API client using wiremock mock server. This completes the "API client with mock server" item in PRD Phase 13.

### Tests Added (`tests/api_integration_tests.rs`)

#### Project API Tests (10 tests)
1. `test_list_projects_success` - Tests listing projects with INBOX prepending
2. `test_get_project_success` - Tests fetching a single project
3. `test_get_project_inbox_special_case` - Tests INBOX project handled locally
4. `test_get_project_not_found` - Tests 404 error handling
5. `test_create_project_success` - Tests project creation with JSON body
6. `test_update_project_success` - Tests project update
7. `test_update_inbox_project_fails` - Tests that INBOX cannot be updated
8. `test_delete_project_success` - Tests project deletion
9. `test_delete_inbox_project_fails` - Tests that INBOX cannot be deleted

#### Task API Tests (5 tests)
1. `test_list_tasks_success` - Tests listing tasks via project data endpoint
2. `test_get_task_success` - Tests fetching a single task
3. `test_create_task_success` - Tests task creation
4. `test_delete_task_success` - Tests task deletion
5. `test_complete_task_success` - Tests marking task complete

#### Error Handling Tests (5 tests)
1. `test_unauthorized_error` - Tests 401 response handling
2. `test_rate_limit_error` - Tests 429 response handling
3. `test_server_error` - Tests 500 response handling
4. `test_bad_request_error` - Tests 400 response handling
5. `test_invalid_json_response` - Tests malformed JSON handling

### Changes Made
- `Cargo.toml`: Added `wiremock` and `tokio-test` dev dependencies
- `src/lib.rs`: Created new file to export modules for integration tests
- `src/api/client.rs`: Added `with_token_and_base_url()` method for custom base URL (for testing)
- `tests/api_integration_tests.rs`: Created new file with 19 integration tests
- `plans/PRD.md`: Marked "API client with mock server" as complete

### Results
- All 157 tests pass (138 unit + 19 integration)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "API client with mock server" requirement complete

## 2026-01-14: Added CLI integration tests with test fixtures (Phase 13)

### What was done
Added comprehensive CLI integration tests using `assert_cmd` and `predicates` crates to complete the "CLI commands with test fixtures" item in PRD Phase 13.

### Tests Added (`tests/cli_tests.rs`)

#### Version Command Tests (3 tests)
1. `test_version_command_text_output` - Tests text output shows version info
2. `test_version_command_json_output` - Tests JSON output format
3. `test_version_command_quiet` - Tests quiet flag suppresses output

#### Help Output Tests (4 tests)
1. `test_help_output` - Tests main help shows all commands
2. `test_project_help_output` - Tests project subcommand help
3. `test_task_help_output` - Tests task subcommand help
4. `test_subtask_help_output` - Tests subtask subcommand help

#### Reset Command Tests (2 tests)
1. `test_reset_nothing_to_reset_text` - Tests text output when nothing to reset
2. `test_reset_nothing_to_reset_json` - Tests JSON output when nothing to reset

#### Init Command Tests (2 tests)
1. `test_init_missing_client_id` - Tests missing TICKTICK_CLIENT_ID error
2. `test_init_missing_client_secret` - Tests missing TICKTICK_CLIENT_SECRET error

#### Project Command Tests (6 tests)
1. `test_project_list_no_token_text` - Tests auth error in text mode
2. `test_project_list_no_token_json` - Tests auth error in JSON mode
3. `test_project_show_no_token` - Tests show without auth
4. `test_project_create_requires_name` - Tests --name is required
5. `test_project_use_requires_argument` - Tests argument required
6. `test_project_delete_requires_id` - Tests ID required

#### Task Command Tests (6 tests)
1. `test_task_list_no_project` - Tests project ID required error
2. `test_task_create_requires_title` - Tests --title is required
3. `test_task_show_requires_id` - Tests ID required
4. `test_task_delete_requires_id` - Tests ID required
5. `test_task_complete_requires_id` - Tests ID required
6. `test_task_uncomplete_requires_id` - Tests ID required

#### Subtask Command Tests (1 test)
1. `test_subtask_list_requires_task_id` - Tests task ID required

#### Global Flags Tests (5 tests)
1. `test_json_flag_position_before_command` - Tests --json before subcommand
2. `test_verbose_flag` - Tests --verbose flag
3. `test_quiet_flag` - Tests --quiet flag
4. `test_short_verbose_flag` - Tests -v short flag
5. `test_short_quiet_flag` - Tests -q short flag

#### Command Alias Tests (2 tests)
1. `test_project_list_alias_ls` - Tests `ls` alias for list
2. `test_task_create_alias_add` - Tests `add` alias for create

#### Invalid Input Tests (3 tests)
1. `test_invalid_command` - Tests unknown command fails
2. `test_invalid_project_subcommand` - Tests unknown project subcommand
3. `test_invalid_task_subcommand` - Tests unknown task subcommand

#### Exit Code Tests (3 tests)
1. `test_success_exit_code` - Tests exit code 0 on success
2. `test_failure_exit_code_invalid_command` - Tests non-zero on error
3. `test_failure_exit_code_missing_required_arg` - Tests non-zero on missing args

### Changes Made
- `Cargo.toml`: Added `assert_cmd`, `predicates`, `tempfile` dev dependencies
- `tests/cli_tests.rs`: Created new file with 37 CLI integration tests
- `plans/PRD.md`: Marked "CLI commands with test fixtures" as complete

### Results
- All 194 tests pass (138 unit + 19 API integration + 37 CLI integration)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "CLI commands with test fixtures" requirement complete

## 2026-01-14: Added OAuth flow simulation tests (Phase 13)

### What was done
Added comprehensive integration tests for OAuth flow simulation to complete the final item in PRD Phase 13's integration tests section.

### Tests Added (`tests/oauth_tests.rs`)

#### Authorization URL Generation Tests (4 tests)
1. `test_auth_url_generation` - Verifies auth URL contains OAuth endpoint, client_id, redirect_uri, state, and scopes
2. `test_auth_url_contains_response_type` - Verifies response_type=code for authorization code flow
3. `test_csrf_token_uniqueness` - Verifies each auth request generates unique CSRF tokens
4. `test_auth_url_uses_https` - Verifies OAuth URL uses HTTPS

#### Token Exchange Tests (2 tests)
1. `test_token_exchange_success` - Tests mock server token endpoint response
2. `test_token_exchange_error_response` - Tests error response handling from token endpoint

#### Callback Parsing Tests (5 tests)
1. `test_callback_parsing_valid_request` - Tests parsing code and state from callback URL
2. `test_callback_parsing_error_response` - Tests recognition of error callbacks
3. `test_callback_parsing_missing_code` - Tests handling of missing code parameter
4. `test_callback_parsing_missing_state` - Tests handling of missing state parameter
5. `test_callback_url_encoding` - Tests URL decoding of callback parameters

#### Callback Server Tests (1 test)
1. `test_callback_server_accepts_connection` - Simulates OAuth redirect with TCP connection

#### AuthHandler Construction Tests (3 tests)
1. `test_auth_handler_creation_with_valid_credentials` - Tests handler with valid credentials
2. `test_auth_handler_with_special_characters_in_credentials` - Tests special chars in client ID/secret
3. `test_auth_handler_empty_credentials` - Tests handler with empty credentials

#### OAuth Flow State Machine Tests (2 tests)
1. `test_oauth_flow_state_transitions` - Documents expected OAuth flow states
2. `test_csrf_token_format` - Verifies CSRF token length and format

#### Security Tests (2 tests)
1. `test_csrf_protection_different_tokens` - Verifies all generated tokens are unique
2. `test_redirect_uri_is_localhost` - Verifies redirect URI uses localhost

### Changes Made
- `tests/oauth_tests.rs`: Created new file with 19 OAuth flow simulation tests
- `plans/PRD.md`: Marked "OAuth flow simulation" as complete

### Results
- All 213 tests pass (138 unit + 19 API integration + 37 CLI integration + 19 OAuth tests)
- `cargo clippy -- -D warnings` passes
- `cargo fmt --check` passes
- PRD Phase 13 "OAuth flow simulation" requirement complete
- Phase 13 (Testing & Quality Assurance) is now FULLY COMPLETE

## 2026-01-14: Added comprehensive README.md documentation (Phase 14)

### What was done
Wrote comprehensive README.md documentation as specified in PRD Phase 14.

### Documentation Sections Added
1. **Features** - Overview of key capabilities (CRUD, JSON output, natural language dates, etc.)
2. **Installation** - From source and with Cargo
3. **Quick Start** - 4-step guide from OAuth setup to first commands
4. **Command Reference** - Full documentation of all commands:
   - Global options (--json, --verbose, --quiet)
   - Root commands (init, reset, version)
   - Project commands (list, show, use, create, update, delete)
   - Task commands (list, show, create, update, delete, complete, uncomplete)
   - Subtask commands (list)
5. **JSON Output** - Success/error response format examples with error codes table
6. **Natural Language Dates** - Table of supported expressions
7. **Configuration** - Config file format, token storage, environment variables
8. **Troubleshooting** - Common issues and solutions
9. **AI Agent Usage** - Tips for automation with example bash script
10. **Development** - Build, test, format, lint commands

### Changes Made
- `README.md`: Complete rewrite with comprehensive documentation
- `plans/PRD.md`: Marked "Write comprehensive README.md" section as complete

### Results
- All 213 tests pass
- `cargo clippy -- -D warnings` passes
- PRD Phase 14 "Write comprehensive README.md" requirement complete

## 2026-01-14: Created .env.example (Phase 14)

### What was done
Created `.env.example` file with environment variable documentation as specified in PRD Phase 14.

### File Contents
- Instructions for obtaining TickTick OAuth credentials (developer portal URL, app registration steps)
- `TICKTICK_CLIENT_ID` - Required OAuth client ID
- `TICKTICK_CLIENT_SECRET` - Required OAuth client secret
- `RUST_LOG` - Optional logging level (defaults to info)

### Changes Made
- `.env.example`: Created new file with comprehensive OAuth setup instructions
- `plans/PRD.md`: Marked "Create .env.example" section as complete

### Results
- All 213 tests pass
- `cargo clippy -- -D warnings` passes
- PRD Phase 14 "Create .env.example" requirement complete

## 2026-01-14: Created CONTRIBUTING.md (Phase 14)

### What was done
Created comprehensive CONTRIBUTING.md documentation as specified in PRD Phase 14.

### Documentation Sections Added
1. **Development Setup** - Prerequisites, getting started, project structure
2. **Code Style Guide** - Formatting, linting, naming conventions, documentation, error handling, API design
3. **Testing Guidelines** - Running tests, test organization, writing tests, test coverage
4. **Pull Request Process** - Before submitting checklist, submitting PR, PR review process
5. **Commit Messages** - Conventional commit format with types and examples
6. **Reporting Issues** - Template for bug reports
7. **Feature Requests** - Guidelines for proposing new features

### Changes Made
- `CONTRIBUTING.md`: Created new file with comprehensive contribution guidelines
- `plans/PRD.md`: Marked "Write CONTRIBUTING.md" section as complete

### Results
- All 213 tests pass
- `cargo clippy -- -D warnings` passes
- PRD Phase 14 "Write CONTRIBUTING.md" requirement complete
